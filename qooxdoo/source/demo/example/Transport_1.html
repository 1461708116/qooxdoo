<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-15" />
  <title>qooxdoo demo</title>
  <link type="text/css" rel="stylesheet" href="../demolayout.css"/>
  <script type="text/javascript" src="../demoinclude.js"></script>
</head>
<body>
  <script type="text/javascript" src="../demolayout.js"></script>

  <div id="demoDescription">
    <p>Testing new qooxdoo transport API.<br/>STILL UNDER DEVELOPMENT!</p>
  </div>

  <script type="text/javascript">
  window.application.main = function()
  {
    var d = this.getClientWindow().getClientDocument();

    var lay = new QxVerticalBoxLayout;
    lay.setLocation(20, 48);
    lay.setRight(335);
    lay.setBottom(48);
    this.add(lay);



    var fsq = new QxFieldSet("Request");
    fsq.setHeight("auto");
    lay.add(fsq);


    var hlay = new QxHorizontalBoxLayout;
    hlay.setVerticalChildrenAlign("middle");
    hlay.setSpacing(4);
    hlay.auto();
    fsq.add(hlay);


    var cm1 = new QxComboBox();
    cm1.add(new QxListItem("data/items/1.xml"));
    cm1.add(new QxListItem("data/items/2.xml"));
    cm1.add(new QxListItem("data/loadByName/Anita.xml"));
    cm1.add(new QxListItem("data/loadByName/Harald.xml"));
    cm1.add(new QxListItem("data/loadByName/Lisbeth.xml"));
    cm1.add(new QxListItem("data/loadByName/Paul.xml"));
    cm1.add(new QxListItem("data/loadByName/404.xml"));
    cm1.setSelected(cm1.getList().getFirstChild());
    cm1.setWidth(200);
    cm1.addEventListener("changeSelected", upd);

    hlay.add(cm1);


    var btn = new QxButton("Send", "icons/16/apply.png");
    btn.addEventListener("execute", upd);
    hlay.add(btn);


    var inf = new QxTextField("Status");
    hlay.add(inf);



    var fsr = new QxFieldSet("Result");
    fsr.setHeight("1*");
    lay.add(fsr);

    var area = new QxTextArea;
    area.setDimension("100%", "100%");
    fsr.add(area);
    
    
    
    
    
    
    
    
    
    
    function upd(e) 
    {
      var val = cm1.getSelected();

      if (!val) {
        return;
      };

      var req = new QxGetRequest(val.getLabel());

      req.addEventListener("sending", function(e) {
        inf.setValue("Sending");
      });

      req.addEventListener("receiving", function(e) {
        inf.setValue("Receiving");
      });

      req.addEventListener("completed", function(e)
      {
        inf.setValue("Completed");
        area.setValue(e.getData().getTextContent());
      });

      req.send();
    };
  };
  </script>
</body>
</html>