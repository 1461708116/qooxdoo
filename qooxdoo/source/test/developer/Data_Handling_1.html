<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-15" />
  <meta http-equiv="MsThemeCompatible" content="yes" />
  <meta http-equiv="ImageToolBar" content="no" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="-1" />
  <meta http-equiv="Cache-Control" content="no-cache" />
  <meta name="MSSmartTagsPreventParsing" content="yes" />
  
  <title>qooxdoo demo release</title>
  <link type="text/css" rel="StyleSheet" href="../../style/layouts/application.css"/>

  <script type="text/javascript" src="../../../tools/script/includer.js"></script>
</head>
<body>
  <script type="text/javascript" src="../../../tools/script/layout.js"></script>    
  
  <div id="testDescription">
    <p>Test for QxData, QxDataManager and QxXmlHttpLoader. The input fields have a noticeable flickering while loading the page. This is because we send 4 load requests for the persons in list below on the page load.</p>
  </div>
  
  <div class="manualFrame" style="top:48px;left:300px;width:220px;height:110px">
    <p><b>Please select a person to show:</b></p>
    <!-- currently hard coded for test, with xmlhttp you could make this more dynamic -->
    <ul>
      <li><a id="Paul" href="javascript:__person__.loadByName('Paul')">Paul</a></li>
      <li><a id="Anita" href="javascript:__person__.loadByName('Anita')">Anita</a></li>
      <li><a id="Harald" href="javascript:__person__.loadByName('Harald')">Harald</a></li>
      <li><a id="Lisbeth" href="javascript:__person__.loadByName('Lisbeth')">Lisbeth</a></li>
    </ul>
  </div>
  
  
  
  <script type="text/javascript">
  /*
  ---------------------------
     Server
  ---------------------------
  */
  
  function PfxPerson()
  {
    QxData.call(this);
  };
  
  PfxPerson.extend(QxData, "PfxPerson");
  
  proto.dispose = function()
  {
    if (this.getDisposed())
      return;
  
    QxData.prototype.dispose.call(this);
  };
  
  proto.loadByName = function(name)
  {
    this.loadData("loadByName[" + name + "]");
  };
  
  proto._parseData_loadByName = function(xmlData)
  {
    return this.mapXmlToObject(this.getResultXml(xmlData));
  };
  
  proto.getName = function(){
    return this._cache.name;
  };
  
  proto.getGivenName = function(){
    return this._cache.givenName;
  };
  
  proto.getAge = function(){
    return this._cache.age;
  };
  
  proto.getStreet = function()
  {
    return this._cache.street;
  };
  
  proto.getPLZ = function()
  {
    return this._cache.plz;
  };
  
  proto.getCity = function()
  {
    return this._cache.city;
  };
  
  proto.getCountry = function()
  {
    return this._cache.country;
  };
  
  proto.getPhone = function()
  {
    return this._cache.phone;
  };
  
  var __person__ = new PfxPerson;     
  </script>
  
  <script type="text/javascript">
  window.application.main = function()
  {
    var win = this.getClientWindow().getDocument();
    
      
  
    var tgiven = new QxTextField;
    tgiven.setTop(48);
    tgiven.setLeft(20);
    tgiven.setWidth(80);
    tgiven.setReadOnly(true);
    win.add(tgiven);
    
    __person__.addEventListener("updateLoadByName", function(e){
      tgiven.setText(e.getData().getGivenName());
    });
    
    
    
    
  
    var tname = new QxTextField;
    tname.setTop(48);
    tname.setLeft(110);
    tname.setWidth(80);
    tname.setReadOnly(true);
    win.add(tname);
  
    __person__.addEventListener("updateLoadByName", function(e){
      tname.setText(e.getData().getName());
    });
    
    
    var tage = new QxTextField;
    tage.setTop(48);
    tage.setLeft(200);
    tage.setWidth(30);
    tage.setReadOnly(true);
    win.add(tage);
    
    __person__.addEventListener("updateLoadByName", function(e){
      tage.setText(e.getData().getAge());
    });
    
  
    var tstreet = new QxTextField;
    tstreet.setTop(78);
    tstreet.setLeft(20);
    tstreet.setWidth(150);
    tstreet.setReadOnly(true);
    win.add(tstreet);
    
    __person__.addEventListener("updateLoadByName", function(e){
      tstreet.setText(e.getData().getStreet());
    });     
    
    
    var tplz = new QxTextField;
    tplz.setTop(108);
    tplz.setLeft(20);
    tplz.setWidth(60);
    tplz.setReadOnly(true);
    win.add(tplz);
    
    __person__.addEventListener("updateLoadByName", function(e){
      tplz.setText(e.getData().getPLZ());
    });    
    
    
    var tcity = new QxTextField;
    tcity.setTop(108);
    tcity.setLeft(90);
    tcity.setWidth(120);
    tcity.setReadOnly(true);
    win.add(tcity);
    
    __person__.addEventListener("updateLoadByName", function(e){
      tcity.setText(e.getData().getCity());
    });  
  
    
    
    var tcountry = new QxTextField;
    tcountry.setTop(138);
    tcountry.setLeft(20);
    tcountry.setWidth(120);
    tcountry.setReadOnly(true);
    win.add(tcountry);
    
    __person__.addEventListener("updateLoadByName", function(e){
      tcountry.setText(e.getData().getCountry());
    }); 
    
    
    var tphone = new QxTextField;
    tphone.setTop(168);
    tphone.setLeft(20);
    tphone.setWidth(120);
    tphone.setReadOnly(true);
    win.add(tphone);
    
    __person__.addEventListener("updateLoadByName", function(e){
      tphone.setText(e.getData().getPhone());
    });     
    
  
    /*
      test the scheduler...
    */  
    __person__.loadByName('Paul');
    __person__.loadByName('Anita');
    __person__.loadByName('Harald');
    __person__.loadByName('Lisbeth');
  };
  </script>
</body>
</html>  